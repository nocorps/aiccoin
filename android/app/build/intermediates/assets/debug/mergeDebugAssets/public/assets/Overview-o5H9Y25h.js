import{_ as $,b as A,x as B,k as tt,c as j,d as s,t as o,y as D,F as st,z as et,A as l,B as i,j as d,C as g,D as T,E as r,o as G,G as at}from"./index-BSy1uvxl.js";const nt={name:"AdminOverview",setup(){const S=A({totalUsers:0,activeTasks:0,totalCollaborations:0,totalCoinsAwarded:0}),e=async()=>{try{const a=await l(i(d,"users"));S.value.totalUsers=a.size;const n=await l(i(d,"tasks"));S.value.activeTasks=n.size;const c=await l(i(d,"collaborationTasks"));S.value.totalCollaborations=c.size;let h=0;(await l(i(d,"completedTasks"))).forEach(m=>{h+=m.data().award||0}),S.value.totalCoinsAwarded=h}catch(a){console.error("Error fetching stats:",a)}},_=A(new Date),t=A({newUsers:0,tasksCompleted:0,coinsAwarded:0,activeUsers:0,newUsersTrend:0,tasksTrend:0,coinsTrend:0,activeUsersTrend:0}),x=B(()=>{const a=new Date;return _.value.toDateString()===a.toDateString()}),R=a=>new Intl.DateTimeFormat("en-US",{weekday:"short",month:"short",day:"numeric"}).format(a),y=a=>{const n=new Date(a);n.setHours(0,0,0,0);const c=new Date(a);return c.setHours(23,59,59,999),{start:n,end:c}},k=async a=>{try{const{start:n,end:c}=y(a),h=g.fromDate(n),v=g.fromDate(c),m=T(i(d,"users"),r("joinDate",">=",h),r("joinDate","<=",v)),u=await l(m);t.value.newUsers=u.size;const C=T(i(d,"completedTasks"),r("completedAt",">=",h),r("completedAt","<=",v)),w=await l(C);t.value.tasksCompleted=w.size;let f=0;w.forEach(E=>{f+=E.data().award||0}),t.value.coinsAwarded=f;const z=T(i(d,"userActivity"),r("lastActive",">=",h),r("lastActive","<=",v)),b=await l(z);t.value.activeUsers=b.size,await I(a)}catch(n){console.error("Error fetching daily stats:",n)}},I=async a=>{const n=new Date(a);n.setDate(n.getDate()-1);const{start:c,end:h}=y(n),v=g.fromDate(c),m=g.fromDate(h),[u,C,w]=await Promise.all([l(T(i(d,"users"),r("joinDate",">=",v),r("joinDate","<=",m))),l(T(i(d,"completedTasks"),r("completedAt",">=",v),r("completedAt","<=",m))),l(T(i(d,"userActivity"),r("lastActive",">=",v),r("lastActive","<=",m)))]);t.value.newUsersTrend=M(u.size,t.value.newUsers),t.value.tasksTrend=M(C.size,t.value.tasksCompleted),t.value.activeUsersTrend=M(w.size,t.value.activeUsers)},M=(a,n)=>a===0?n>0?100:0:(n-a)/a*100,Y=a=>a>0?"positive":a<0?"negative":"neutral",O=a=>`${a>0?"â†‘":a<0?"â†“":"âˆ’"} ${Math.abs(a).toFixed(1)}%`,H=a=>{const n=new Date(_.value);n.setDate(n.getDate()+a),n<=new Date&&(_.value=n,k(n))},U=A(new Date),Q=A({totalUsers:0,userGrowth:[],maxGrowth:0,completionRate:0,completionTrend:0,revenue:0,revenueTrend:0,retention:0,retentionTrend:0}),P=B(()=>{const a=new Date;return U.value.getMonth()===a.getMonth()&&U.value.getFullYear()===a.getFullYear()}),q=a=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long"}).format(a),L=a=>new Intl.NumberFormat("en-US").format(a),N=async a=>{try{const n=a.getFullYear(),c=a.getMonth(),h=new Date(n,c,1),v=new Date(n,c+1,0),m=g.fromDate(h),u=g.fromDate(v),C=T(i(d,"users"),r("joinDate",">=",m),r("joinDate","<=",u)),w=await l(C),f=Array(v.getDate()).fill(0);w.forEach(F=>{const Z=F.data().joinDate.toDate();f[Z.getDate()-1]++});const z=T(i(d,"completedTasks"),r("completedAt",">=",m),r("completedAt","<=",u)),b=await l(z),E=await l(i(d,"tasks")),K=b.size/(E.size*w.size)*100;let p=0;b.forEach(F=>{p+=F.data().award||0});const W=T(i(d,"userActivity"),r("lastActive",">=",m),r("lastActive","<=",u)),X=(await l(W)).size/w.size*100;Q.value={totalUsers:w.size,userGrowth:f,maxGrowth:Math.max(...f),completionRate:Math.round(K),completionTrend:0,revenue:p,revenueTrend:0,retention:Math.round(X),retentionTrend:0},await V(a)}catch(n){console.error("Error fetching monthly stats:",n)}},V=async a=>{new Date(a.getFullYear(),a.getMonth()-1)},J=a=>{const n=new Date(U.value);n.setMonth(n.getMonth()+a),n<=new Date&&(U.value=n,N(n))};return tt(async()=>{await e(),await k(new Date),await N(new Date)}),{stats:S,dailyStats:t,selectedDate:_,isToday:x,formatDate:R,changeDate:H,getTrendClass:Y,formatTrend:O,selectedMonth:U,monthlyStats:Q,isCurrentMonth:P,formatMonth:q,formatNumber:L,changeMonth:J}}},ot={class:"overview-container"},rt={class:"stats-grid"},lt={class:"stat-card"},it={class:"stat-value"},dt={class:"stat-card"},ct={class:"stat-value"},vt={class:"stat-card"},mt={class:"stat-value"},ht={class:"stat-card"},yt={class:"stat-value"},wt={class:"daily-stats-section"},Tt={class:"date-controls"},ut={class:"current-date"},Dt=["disabled"],St={class:"daily-stats-grid"},ft={class:"stat-card"},gt={class:"stat-value"},_t={class:"stat-card"},kt={class:"stat-value"},Ut={class:"stat-card"},Ct={class:"stat-value"},At={class:"stat-card"},bt={class:"stat-value"},Mt={class:"monthly-stats-section"},zt={class:"month-controls"},Et={class:"current-month"},Ft=["disabled"],jt={class:"monthly-stats-grid"},Gt={class:"stat-card"},xt={class:"stat-value"},Rt={class:"monthly-chart"},Qt=["title"],Nt={class:"stat-card"},pt={class:"stat-value"},Bt={class:"stat-card"},It={class:"stat-value"},Yt={class:"stat-card"},Ot={class:"stat-value"};function Ht(S,e,_,t,x,R){return G(),j("div",ot,[s("div",rt,[s("div",lt,[e[4]||(e[4]=s("h3",null,"Total Users",-1)),s("div",it,o(t.stats.totalUsers),1),e[5]||(e[5]=s("div",{class:"stat-icon"},"ðŸ‘¥",-1))]),s("div",dt,[e[6]||(e[6]=s("h3",null,"Active Tasks",-1)),s("div",ct,o(t.stats.activeTasks),1),e[7]||(e[7]=s("div",{class:"stat-icon"},"ðŸ“",-1))]),s("div",vt,[e[8]||(e[8]=s("h3",null,"Total Collaborations",-1)),s("div",mt,o(t.stats.totalCollaborations),1),e[9]||(e[9]=s("div",{class:"stat-icon"},"ðŸ¤",-1))]),s("div",ht,[e[10]||(e[10]=s("h3",null,"Coins Awarded",-1)),s("div",yt,o(t.stats.totalCoinsAwarded),1),e[11]||(e[11]=s("div",{class:"stat-icon"},"ðŸª™",-1))])]),s("div",wt,[e[16]||(e[16]=s("h2",null,"Daily Analytics",-1)),s("div",Tt,[s("button",{onClick:e[0]||(e[0]=y=>t.changeDate(-1)),class:"date-btn"},"â—€"),s("span",ut,o(t.formatDate(t.selectedDate)),1),s("button",{onClick:e[1]||(e[1]=y=>t.changeDate(1)),class:"date-btn",disabled:t.isToday},"â–¶",8,Dt)]),s("div",St,[s("div",ft,[e[12]||(e[12]=s("h3",null,"New Users",-1)),s("div",gt,o(t.dailyStats.newUsers),1),s("div",{class:D(["trend",t.getTrendClass(t.dailyStats.newUsersTrend)])},o(t.formatTrend(t.dailyStats.newUsersTrend)),3)]),s("div",_t,[e[13]||(e[13]=s("h3",null,"Tasks Completed",-1)),s("div",kt,o(t.dailyStats.tasksCompleted),1),s("div",{class:D(["trend",t.getTrendClass(t.dailyStats.tasksTrend)])},o(t.formatTrend(t.dailyStats.tasksTrend)),3)]),s("div",Ut,[e[14]||(e[14]=s("h3",null,"Coins Distributed",-1)),s("div",Ct,o(t.dailyStats.coinsAwarded),1),s("div",{class:D(["trend",t.getTrendClass(t.dailyStats.coinsTrend)])},o(t.formatTrend(t.dailyStats.coinsTrend)),3)]),s("div",At,[e[15]||(e[15]=s("h3",null,"Active Users",-1)),s("div",bt,o(t.dailyStats.activeUsers),1),s("div",{class:D(["trend",t.getTrendClass(t.dailyStats.activeUsersTrend)])},o(t.formatTrend(t.dailyStats.activeUsersTrend)),3)])])]),s("div",Mt,[e[21]||(e[21]=s("h2",null,"Monthly Overview",-1)),s("div",zt,[s("button",{onClick:e[2]||(e[2]=y=>t.changeMonth(-1)),class:"month-btn"},"â—€"),s("span",Et,o(t.formatMonth(t.selectedMonth)),1),s("button",{onClick:e[3]||(e[3]=y=>t.changeMonth(1)),class:"month-btn",disabled:t.isCurrentMonth},"â–¶",8,Ft)]),s("div",jt,[s("div",Gt,[e[17]||(e[17]=s("h3",null,"Monthly Growth",-1)),s("div",xt,o(t.monthlyStats.totalUsers),1),s("div",Rt,[(G(!0),j(st,null,et(t.monthlyStats.userGrowth,(y,k)=>(G(),j("div",{key:k,class:"chart-bar",style:at({height:`${y/t.monthlyStats.maxGrowth*100}%`}),title:`${y} users on day ${k+1}`},null,12,Qt))),128))])]),s("div",Nt,[e[18]||(e[18]=s("h3",null,"Task Completion Rate",-1)),s("div",pt,o(t.monthlyStats.completionRate)+"%",1),s("div",{class:D(["trend",t.getTrendClass(t.monthlyStats.completionTrend)])},o(t.formatTrend(t.monthlyStats.completionTrend)),3)]),s("div",Bt,[e[19]||(e[19]=s("h3",null,"Monthly Revenue",-1)),s("div",It,o(t.formatNumber(t.monthlyStats.revenue)),1),s("div",{class:D(["trend",t.getTrendClass(t.monthlyStats.revenueTrend)])},o(t.formatTrend(t.monthlyStats.revenueTrend)),3)]),s("div",Yt,[e[20]||(e[20]=s("h3",null,"User Retention",-1)),s("div",Ot,o(t.monthlyStats.retention)+"%",1),s("div",{class:D(["trend",t.getTrendClass(t.monthlyStats.retentionTrend)])},o(t.formatTrend(t.monthlyStats.retentionTrend)),3)])])])])}const Lt=$(nt,[["render",Ht],["__scopeId","data-v-91f90fed"]]);export{Lt as default};
